(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{187:function(e,t,a){},189:function(e,t,a){"use strict";a.r(t);var n,i,r=a(0),c=a.n(r),l=a(61),o=a.n(l),s=a(26),d=a.n(s),j=a(38),u=a(15),g=a(23),b=a(247),p=a(253),m=a(246),h=a(255),O=a(251),x=a(252),f=a(254),v=a(250),y=a(249),w=a(248),T=a(101),I=a.n(T),k=a(102),$=a.n(k),D=a(100),S=a.n(D),C=a(81),R=a(24),N=a(105),B=a(120),_=a(152),U=a(2),W={display:"flex",flexDirection:"row",flexWrap:"wrap",marginTop:16},q={display:"inline-flex",borderRadius:2,border:"1px solid #eaeaea",marginBottom:8,marginRight:8,width:100,height:100,padding:4,boxSizing:"border-box"},P={display:"flex",minWidth:0,overflow:"hidden"},A={display:"block",width:"auto",height:"100%"},F=B.a.div(n||(n=Object(g.a)(["\nflex: 1;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\npadding: 20px;\nborder-width: 2px;\nborder-radius: 2px;\nborder-color: #eeeeee;\nborder-style: dashed;\nbackground-color: #fafafa;\ncolor: #bdbdbd;\noutline: none;\ntransition: border .24s ease-in-out;\nopacity: 1.0;\n"]))),E=B.a.section(i||(i=Object(g.a)(["\ndisplay: flex;\nflex-direction: column;\n// width: 700px;\n// justify-self: center;\n// margin-right: auto;\n// margin-left: auto;\n"])));function L(e){var t=Object(r.useState)([]),a=Object(u.a)(t,2),n=a[0],i=a[1],c=Object(_.a)({accept:"image/*",onDrop:function(t){i(t.map((function(e){return Object.assign(e,{preview:URL.createObjectURL(e)})}))),t.forEach((function(t){e.onDrop(t)}))}}),l=c.getRootProps,o=c.open,s=c.getInputProps,d=n.map((function(e){return Object(U.jsx)("div",{style:q,children:Object(U.jsx)("div",{style:P,children:Object(U.jsx)("img",{src:e.preview,style:A})})},e.name)}));return Object(r.useEffect)((function(){return function(){n.forEach((function(e){return URL.revokeObjectURL(e.preview)}))}}),[n]),Object(U.jsxs)(E,{children:[Object(U.jsxs)(F,Object(N.a)(Object(N.a)({},l({className:"dropzone"})),{},{children:[Object(U.jsx)("input",Object(N.a)({},s())),Object(U.jsx)("p",{children:"Drag 'n' drop some files here, or click to select files"}),Object(U.jsx)(m.a,{variant:"outlined",type:"button",onClick:o,children:"Open File Dialog"})]})),Object(U.jsx)("aside",{style:W,children:d})]})}var M="http://127.0.0.1:8000";function z(e,t){return H.apply(this,arguments)}function H(){return(H=Object(j.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Asking for creating a request: "),(n=new FormData).append("title",a),n.append("image",new Blob([t],{type:"image/jpg"})),e.next=6,fetch("".concat(M,"/api/create-image"),{method:"POST",body:n});case 6:return e.sent,e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J,X,V,G,K,Q=a(238),Y=a(256),Z=a(239),ee=a(242),te=a(123),ae=a(53),ne=a(245),ie=a(241),re=a(240),ce=a(258),le=a(234),oe=a(244),se=a(230),de={PaperProps:{style:{maxHeight:224,width:250}}},je=Object(Q.a)(J||(J=Object(g.a)(["\n  mutation connectTag($idImage: ID!, $idTag: [ID!]!) {\n    connectTag(idImage: $idImage, idTag: $idTag) {\n      success\n    }\n  }\n"]))),ue=Object(Q.a)(X||(X=Object(g.a)(["\n  query vacantTags($idImage: ID!) {\n    vacantTags(idImage: $idImage) {\n      id\n      tagName\n    }\n  }\n"]))),ge=Object(Q.a)(V||(V=Object(g.a)(["\n  query imageTags($idImage: ID!) {\n    imageTags(idImage: $idImage) {\n      id\n      tagName\n    }\n  }\n"]))),be=Object(Q.a)(G||(G=Object(g.a)(["\n  mutation imageTags($idImage: ID!, $idTag: ID!) {\n    removeTagConnection(idImage: $idImage, idTag: $idTag) {\n      success\n    }\n  }\n"])));function pe(e,t,a){return{fontWeight:-1===t.indexOf(e)?a.typography.fontWeightRegular:a.typography.fontWeightMedium}}function me(e){var t=Object(ae.a)(),a=r.useState([]),n=Object(u.a)(a,2),i=n[0],c=n[1],l=r.useState(!1),o=Object(u.a)(l,2),s=o[0],g=o[1],p=Object(Y.a)(je),h=Object(u.a)(p,1)[0],O=Object(Y.a)(be),x=Object(u.a)(O,1)[0],f=Object(Z.a)(ue,{variables:{idImage:e.image_id}}),v=Object(Z.a)(ge,{variables:{idImage:e.image_id}}),y=function(){var t=Object(j.a)(d.a.mark((function t(){var a,n,r,l,o,s,j;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Handle uploading"),a=[],n=Object(te.a)(i);try{for(n.s();!(r=n.n()).done;){l=r.value,o=Object(te.a)(f.data.vacantTags);try{for(o.s();!(s=o.n()).done;)(j=s.value).tagName===l&&a.push(parseInt(j.id))}catch(d){o.e(d)}finally{o.f()}}}catch(d){n.e(d)}finally{n.f()}if(console.log(a,e.image_id),a.length){t.next=7;break}return t.abrupt("return");case 7:return c([]),t.next=10,h({variables:{idImage:e.image_id,idTag:a}});case 10:f.refetch(),v.refetch();case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return v.loading||f.loading?null:Object(U.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(U.jsx)(se.a,{spacing:1,width:"700px",direction:"row",marginBottom:"20px",marginTop:"10px",flexWrap:"wrap",children:v.data.imageTags.map((function(t,a){return Object(U.jsx)(oe.a,{style:{marginTop:"10px"},label:t.tagName,onDelete:(n=t,Object(j.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x({variables:{idImage:e.image_id,idTag:n.id}});case 2:f.refetch(),v.refetch();case 4:case"end":return t.stop()}}),t)}))))},t.id);var n}))}),Object(U.jsxs)(ce.a,{sx:{m:1,width:300},children:[Object(U.jsx)(ie.a,{id:"demo-multiple-chip-label",children:"Available Tags"}),Object(U.jsx)(le.a,{labelId:"demo-multiple-chip-label",id:"demo-multiple-chip",multiple:!0,value:i,onChange:function(e){var t=e.target.value;0!==t.length&&g(!0),c("string"===typeof t?t.split(","):t)},input:Object(U.jsx)(ne.a,{id:"select-multiple-chip",label:"Available Tags"}),renderValue:function(e){return Object(U.jsx)(b.a,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((function(e,t){return Object(U.jsx)(oe.a,{label:e},t)}))})},MenuProps:de,children:f.data.vacantTags.map((function(e,a){return Object(U.jsx)(re.a,{value:e.tagName,style:pe(e.tagName,i,t),children:e.tagName},e.id)}))})]}),s?Object(U.jsx)(m.a,{style:{marginTop:"10px",width:"120px"},variant:"contained",type:"button",onClick:y,children:"Save tags"}):null]})}var he,Oe,xe,fe=Object(Q.a)(K||(K=Object(g.a)(["\n  query image($image: String!) {\n    image(image: $image) {\n      id\n      title\n      image\n    }\n  }\n"])));function ve(){var e,t=Object(R.f)().pathname.split("/"),a=Object(Z.a)(fe,{variables:{image:"pic_storage/"+t[t.length-1]}}),n=a.loading,i=(a.error,a.data);return n?null:Object(U.jsxs)(b.a,{margin:"10%",marginTop:"150px",children:[Object(U.jsx)(y.a,{variant:"h3",component:"h2",marginBottom:"20px",children:null===i||void 0===i?void 0:i.image.title}),n?null:Object(U.jsx)("img",{src:(e=null===i||void 0===i?void 0:i.image.image,"http://127.0.0.1:8000/api/get-image/"+e),style:{width:800,height:600}}),Object(U.jsx)(me,{image_id:i.image.id})]})}var ye=Object(Q.a)(he||(he=Object(g.a)(["\n  query allImages {\n    allImages {\n      id\n      title\n      image\n      uploaderIp\n      uploadDateTime\n    }\n  }\n"]))),we=Object(Q.a)(Oe||(Oe=Object(g.a)(["\n  mutation updateImage($id: ID!, $title: String!){\n  updateImage(id: $id, title: $title) {\n    image {\n      id\n      title\n    }\n  }\n}\n"]))),Te=Object(Q.a)(xe||(xe=Object(g.a)(["\n  mutation deleteImage($id: ID!) {\n    deleteImage(id: $id) {\n      deleted\n    }\n  }\n"])));function Ie(e){var t=e.row,a=c.a.useState(0),n=Object(u.a)(a,2),i=n[0],r=n[1],l=c.a.useState(t.title),o=Object(u.a)(l,2),s=o[0],g=o[1],b=c.a.useState(t.title),p=Object(u.a)(b,2),m=p[0],h=p[1],x=Object(Y.a)(we),f=Object(u.a)(x,2),y=f[0],w=f[1],T=(w.data,w.loading,w.error,Object(Y.a)(Te)),k=Object(u.a)(T,1)[0],D="#8f8f8f",R=(c.a.useRef(null),function(){var a=Object(j.a)(d.a.mark((function a(){var n;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k({variables:{id:t.index}});case 2:n=a.sent,console.log(n),e.refetch();case 5:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}());return Object(U.jsx)(c.a.Fragment,{children:Object(U.jsxs)(v.a,{sx:{"& > *":{borderBottom:"unset"}},children:[Object(U.jsx)(O.a,{children:t.index}),Object(U.jsx)(O.a,{component:"th",scope:"row",children:i?Object(U.jsx)(ee.a,{onChange:function(e){g(e.target.value)},value:s,id:"margin-none"}):Object(U.jsx)(C.b,{to:"/test/images/preview/"+t.link,style:{cursor:"pointer"},children:m})}),Object(U.jsx)(O.a,{align:"right",children:t.upload_date}),Object(U.jsx)(O.a,{align:"right",children:t.uploader_ip}),Object(U.jsxs)(O.a,{align:"right",children:[i?Object(U.jsx)(S.a,{onClick:function(){h(s),y({variables:{id:t.index,title:s}}),r(0)},style:{marginRight:"10px",color:D,cursor:"pointer"}}):Object(U.jsx)(I.a,{onClick:function(){r(1)},style:{marginRight:"10px",color:D,cursor:"pointer"}}),Object(U.jsx)($.a,{onClick:R,style:{color:D,cursor:"pointer"}})]})]})})}function ke(e){var t=e.split("T"),a=t[1].split(".");return t[0]+" "+a[0]}function $e(){var e=c.a.useState(0),t=Object(u.a)(e,2),a=t[0],n=t[1],i=c.a.useState(null),r=Object(u.a)(i,2),l=r[0],o=r[1],s=c.a.useState(null),g=Object(u.a)(s,2),T=g[0],I=g[1],k=c.a.useState("Unknown"),$=Object(u.a)(k,2),D=($[0],$[1],Object(Z.a)(ye)),S=(D.loading,D.error,D.data),C=D.refetch,N=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(T,l.name);case 2:C();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(R.f)();return Object(U.jsxs)(R.c,{children:[Object(U.jsx)(R.a,{exact:!0,path:"/test/images/",children:Object(U.jsxs)(b.a,{margin:"10%",marginTop:"150px",children:[Object(U.jsx)(y.a,{variant:"h3",component:"h2",marginBottom:"20px",children:"Image table"}),Object(U.jsx)(x.a,{component:w.a,children:Object(U.jsxs)(p.a,{"aria-label":"collapsible table",children:[Object(U.jsx)(f.a,{children:Object(U.jsxs)(v.a,{children:[Object(U.jsx)(O.a,{children:"Id"}),Object(U.jsx)(O.a,{children:"Title"}),Object(U.jsx)(O.a,{align:"right",children:"Upload date"}),Object(U.jsx)(O.a,{align:"right",children:"Uploader's IP"}),Object(U.jsx)(O.a,{align:"right",children:"Operations"})]})}),Object(U.jsx)(h.a,{children:null===S||void 0===S?void 0:S.allImages.map((function(e,t){return Object(U.jsx)(Ie,{refetch:C,row:{title:e.title,index:e.id,link:e.image,upload_date:ke(e.uploadDateTime),uploader_ip:e.uploaderIp}},t)}))})]})}),Object(U.jsxs)(b.a,{marginTop:"30px",width:"100%",marginX:"auto",children:[Object(U.jsx)(L,{onDrop:function(e){console.log("File dropped: "+e.name);var t=new FileReader;t.onabort=function(){return console.log("file reading was aborted")},t.onerror=function(){return console.log("file reading has failed")},t.onload=function(){var a=t.result;o(e),I(a),n(1)},t.readAsArrayBuffer(e)}}),Object(U.jsx)(b.a,{width:"100px",justifySelf:"center",display:"flex",flexDirection:"column",alignContent:"center",marginX:"auto",children:a?Object(U.jsx)(m.a,{variant:"contained",type:"button",onClick:N,children:"Upload"}):null})]})]})}),Object(U.jsx)(R.a,{path:"/test/images/preview",children:Object(U.jsx)(ve,{})})]})}a(187);var De,Se,Ce,Re,Ne=a(235),Be=a(236),_e=a(233),Ue=Object(Q.a)(De||(De=Object(g.a)(["\n  mutation renameTag($id: ID!, $name: String!) {\n    renameTag(id: $id, name: $name) {\n      tag {\n        id\n        tagName\n      }\n    }\n  }\n"]))),We=Object(Q.a)(Se||(Se=Object(g.a)(["\n  mutation deleteTag($id: ID!) {\n    deleteTag(id: $id) {\n      tag {\n        tagName\n      }\n    }\n  }\n"]))),qe=Object(Q.a)(Ce||(Ce=Object(g.a)(["\n  mutation createTag($name: String!) {\n    createTag(name: $name) {\n      tag {\n        id\n        tagName\n      }\n    }\n  }\n"]))),Pe=Object(Q.a)(Re||(Re=Object(g.a)(["\n  query {\n  allTags {\n    id\n    tagName\n  }\n}\n"])));function Ae(e){var t=e.row,a=c.a.useState(0),n=Object(u.a)(a,2),i=n[0],r=n[1],l=c.a.useState(t.tagName),o=Object(u.a)(l,2),s=o[0],g=o[1],b=c.a.useState(t.tagName),p=Object(u.a)(b,2),m=p[0],h=p[1],x=Object(Y.a)(Ue),f=Object(u.a)(x,2),y=f[0],w=f[1],T=(w.data,w.loading,w.error,Object(Y.a)(We)),k=Object(u.a)(T,1)[0],D="#8f8f8f",C=(c.a.useRef(null),function(){var a=Object(j.a)(d.a.mark((function a(){return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k({variables:{id:t.id}});case 2:a.sent,e.refetch();case 4:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}());return Object(U.jsx)(c.a.Fragment,{children:Object(U.jsxs)(v.a,{children:[Object(U.jsx)(O.a,{component:"th",scope:"row",children:t.id}),Object(U.jsx)(O.a,{align:"left",children:i?Object(U.jsx)(ee.a,{onChange:function(e){g(e.target.value)},value:s}):m}),Object(U.jsxs)(O.a,{align:"right",children:[i?Object(U.jsx)(S.a,{onClick:function(){h(s),y({variables:{id:t.id,name:s}}),r(0)},style:{marginRight:"10px",color:D,cursor:"pointer"}}):Object(U.jsx)(I.a,{onClick:function(){r(1)},style:{marginRight:"10px",color:D,cursor:"pointer"}}),Object(U.jsx)($.a,{onClick:C,style:{color:D,cursor:"pointer"}})]})]},t.id)})}function Fe(e){var t=Object(r.useState)(""),a=Object(u.a)(t,2),n=a[0],i=a[1],c=Object(Z.a)(Pe),l=(c.loading,c.error,c.data),o=c.refetch,s=Object(Y.a)(qe),g=Object(u.a)(s,1)[0],T=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g({variables:{name:n}});case 3:o(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Duplicate entry!!");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(U.jsxs)(b.a,{margin:"10%",marginTop:"150px",children:[Object(U.jsx)(y.a,{variant:"h3",component:"h2",marginBottom:"20px",children:"Tag table"}),Object(U.jsx)(x.a,{component:w.a,children:Object(U.jsxs)(p.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(U.jsx)(f.a,{children:Object(U.jsxs)(v.a,{children:[Object(U.jsx)(O.a,{children:"Id"}),Object(U.jsx)(O.a,{align:"left",children:"Tag name"}),Object(U.jsx)(O.a,{align:"right",children:"Operations"})]})}),Object(U.jsx)(h.a,{children:null===l||void 0===l?void 0:l.allTags.map((function(e,t){return Object(U.jsx)(Ae,{row:e,refetch:o},e.id)}))})]})}),Object(U.jsxs)(b.a,{display:"flex",flexDirection:"column",children:[Object(U.jsx)(y.a,{variant:"h5",marginTop:"40px",marginBottom:"20px",children:"Add new tag"}),Object(U.jsx)(ee.a,{onChange:function(e){i(e.target.value)},label:"Tag name",style:{marginBottom:"10px",width:"200px"},value:n,id:"margin-none"}),Object(U.jsx)(m.a,{onClick:T,style:{width:"80px"},variant:"contained",children:"Save"})]})]})}var Ee=new Ne.a({uri:"http://127.0.0.1:8000/graphql",cache:new Be.a});o.a.render(Object(U.jsx)(_e.a,{client:Ee,children:Object(U.jsx)(c.a.StrictMode,{children:Object(U.jsx)(C.a,{children:Object(U.jsxs)(R.c,{children:[Object(U.jsx)(R.a,{path:"/test/images",children:Object(U.jsx)($e,{})}),Object(U.jsx)(R.a,{path:"/test/tags",children:Object(U.jsx)(Fe,{})})]})})})}),document.getElementById("root"))}},[[189,1,2]]]);
//# sourceMappingURL=main.1c63665d.chunk.js.map